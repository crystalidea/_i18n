---
permalink: /blog/malware-abusing-anytoiso-and-crystalbit-solutions
layout: blog-post
title: "Malware abusing AnyToISO and CrystalBit Solutions"
image: /assets/images/blog/malware.jpg
tags: ["anytoiso"]
---

We've received two reports from people running Windows who were infected by a Trojan (or some another kind of malware) by executing a file signed by our company (CrystalBit Solutions). More specifically this executable had the [AnyToISO](/anytoiso) icon. How can this be possible? 

Unfortunately, it is possible by using a common technique used by cybercriminals called - [DLL Search Order Hijacking](https://resources.infosecinstitute.com/dll-hijacking-attacks-revisited/). In short:

<!--more-->

- malware makers use a legitimate executable file signed by a valid digital signature - they simply don't have their own digital certificate to sign files. In our case they used AnyToISO uninstaller program **unins000.exe** and renamed it to some random name
- every executable has a list of required Windows system DLL files that must be loaded when this executable starts. In our case **msimg32.dll** is among them, this Windows library is responsible for Windows graphics device interface (GDI) manipulation
- malware makers put an infected DLL file into the same archive/folder along with legitimate executable. This DLL has the same name (**msimg32.dll**) as the one from the the required list
- once you run the signed executable Windows looks for required DLL files and gives priority to the local-infected DLL instead of the system one
- infected DLL is loaded into the legitimate process and does its bad things

Bad news is that basically every legitimate and popular app can be abused like that in the Windows world. There's a known case with [TeamViewer](https://blog.avast.com/a-deeper-look-into-malware-abusing-teamviewer), for example.

### What did we learn?

- There have never been any infected files in our apps and on the website
- Don't visit doubtful websites
- Use AntiVirus/Antispyware protection at all times and update it regularly. Windows 10 built-in Windows Defender does its job great

### Some technical details:

VirusTotal links for some variants of our signed **unins000.exe** that were misused by cybercriminals - [#1](https://www.virustotal.com/gui/file/784102cb5eed67931b6d6037168c7335718776826c24c1c5e2af3903f8a72064/detection) [#2](https://www.virustotal.com/gui/file/d2d96c8ffeaee55a47b37cdc65dbd2bc1244b5c65c44b0825e6ab35bb9f3aa87/detection).  
VirusTotal links for some variants of infected **msimg32.dll** - [#1](https://www.virustotal.com/gui/file/124b81a99dc1b5baefd9df7fa17d146cc9bcdbc29eb49fa6866ac4e7c769839e/detection) [#2](https://www.virustotal.com/gui/file/aebe99b84f571b460d6e05b2b7b644cb6c11e891b625390963e57ec5470ea15b/detection).

### Demo:

<p class="text-center">
    <img src="/assets/images/blog/malware-demo.png">
</p>
